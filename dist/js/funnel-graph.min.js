!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).FunnelGraph=t()}(function(){return function n(i,a,o){function s(e,t){if(!a[e]){if(!i[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(l)return l(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}r=a[e]={exports:{}},i[e][0].call(r.exports,function(t){return s(i[e][1][t]||t)},r,r.exports,n,i,a,o)}return a[e].exports}for(var l="function"==typeof require&&require,t=0;t<o.length;t++)s(o[t]);return s}({1:[function(t,e,r){e.exports=t("./src/js/main").default},{"./src/js/main":3}],2:[function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.setAttrs=r.removeAttrs=r.getDefaultColors=r.generateLegendBackground=r.defaultColors=r.createSVGElement=r.areEqual=void 0;var i=r.setAttrs=function(e,r){"object"===n(r)&&Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])})},a=(r.removeAttrs=function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach(function(t){e.removeAttribute(t)})},r.createSVGElement=function(t,e,r){t=document.createElementNS("http://www.w3.org/2000/svg",t);return"object"===n(r)&&i(t,r),void 0!==e&&e.appendChild(t),t},r.generateLegendBackground=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"horizontal";return"string"==typeof t?"background-color: ".concat(t):1===t.length?"background-color: ".concat(t[0]):"background-image: linear-gradient(".concat("horizontal"===e?"to right, ":"").concat(t.join(", "),")")},r.defaultColors=["#FF4589","#FF5050","#05DF9D","#4FF2FD","#2D9CDB","#A0BBFF","#FFD76F","#F2C94C","#FF9A9A","#FFB178"]);r.getDefaultColors=function(t){for(var e=[].concat(a),r=[],n=0;n<t;n++){var i=Math.abs(Math.round(Math.random()*(e.length-1)));r.push(e[i]),e.splice(i,1)}return r},r.areEqual=function(t,e){var r=Object.prototype.toString.call(t);if(r!==Object.prototype.toString.call(e))return!1;if("[object Array]"!==r)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++){var i=Object.prototype.toString.call(t[n]);if(i!==Object.prototype.toString.call(e[n]))return!1;if("[object Array]"===i){if(t[n].length!==e[n].length)return!1;for(var a=0;a<t[n].length;a++)if(t[n][a]!==e[n][a])return!1}else if(t[n]!==e[n])return!1}return!0}},{}],3:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var d=t("./number"),u=t("./path"),s=t("./graph"),l=(t=t("./random"))&&t.__esModule?t:{default:t};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){{var r;if(t)return"string"==typeof t?n(t,e):"Map"===(r="Object"===(r={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==i(t)?t:t+""}(n.key),n)}}t=function(){function n(t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.containerSelector=t.container,this.gradientDirection=t.gradientDirection&&"vertical"===t.gradientDirection?"vertical":"horizontal",this.direction=t.direction&&"vertical"===t.direction?"vertical":"horizontal",this.labels=n.getLabels(t),this.subLabels=n.getSubLabels(t),this.labelValues=n.getLabelValues(t),this.graphValues=n.getGraphValues(t),this.percentages=this.createPercentages(),this.colors=t.data.colors||(0,s.getDefaultColors)(this.is2d()?this.getSubDataSize():2),this.displayPercent=t.displayPercent||!1,this.data=t.data,this.height=t.height,this.width=t.width,this.subLabelValue=t.subLabelValue||"percent",this.precision=t.precision||2,this.formatter=t.formatter||d.outputFormatter}return t=n,r=[{key:"getSubLabels",value:function(t){if(t.data)return void 0===(t=t.data).subLabels?[]:t.subLabels;throw new Error("Data is missing")}},{key:"getLabels",value:function(t){if(t.data)return void 0===(t=t.data).labels?[]:t.labels;throw new Error("Data is missing")}},{key:"getLabelValues",value:function(t){return t.data&&"object"===i(t=t.data)?t.labelValues||t.graphValues:[]}},{key:"getGraphValues",value:function(t){return t.data&&"object"===i(t=t.data)?t.graphValues:[]}}],(e=[{key:"getMainAxisPoints",value:function(){for(var t=this.getDataSize(),e=[],r=this.isVertical()?this.getHeight():this.getWidth(),n=0;n<=t;n++)e.push((0,d.roundPoint)(r*n/t));return e}},{key:"getCrossAxisPoints",value:function(){var t=[],e=this.getFullDimension(),r=e/2;if(this.is2d()){for(var n=this.getValues2d(),i=Math.max.apply(Math,f(n)),a=(n.push(f(n).pop()),t.push(n.map(function(t){return(0,d.roundPoint)((i-t)/i*r)})),this.getPercentages2d()),o=t[0],s=1;s<this.getSubDataSize();s++){for(var l=t[s-1],u=[],c=0;c<this.getDataSize();c++)u.push((0,d.roundPoint)(l[c]+(e-2*o[c])*(a[c][s-1]/100)));u.push([].concat(u).pop()),t.push(u)}t.push(o.map(function(t){return e-t}))}else{var h=Math.max.apply(Math,f(this.graphValues)),n=f(this.graphValues).concat(f(this.graphValues).pop());t.push(n.map(function(t){return(0,d.roundPoint)((h-t)/h*r)})),t.push(t[0].map(function(t){return e-t}))}return t}},{key:"getGraphType",value:function(){return this.graphValues&&this.graphValues[0]instanceof Array?"2d":"normal"}},{key:"is2d",value:function(){return"2d"===this.getGraphType()}},{key:"isVertical",value:function(){return"vertical"===this.direction}},{key:"getDataSize",value:function(){return this.graphValues.length}},{key:"getSubDataSize",value:function(){return this.graphValues[0].length}},{key:"getFullDimension",value:function(){return this.isVertical()?this.getWidth():this.getHeight()}},{key:"addLabels",value:function(){var l=this,u=document.createElement("div");u.setAttribute("class","svg-funnel-js__labels"),this.percentages.forEach(function(t,n){var i,a,e=document.createElement("div"),r=(e.setAttribute("class","svg-funnel-js__label label-".concat(n+1)),document.createElement("div")),o=(r.setAttribute("class","label__title"),r.textContent=l.labels[n]||"",document.createElement("div")),s=(o.setAttribute("class","label__value"),(l.is2d()?l.getValues2d(!0):l.labelValues)[n]),s=(o.textContent=l.formatter((0,d.formatNumber)(s,l.precision)),document.createElement("div"));s.setAttribute("class","label__percentage"),s.textContent="".concat(t.toString(),"%"),e.appendChild(o),e.appendChild(r),l.displayPercent&&e.appendChild(s),l.is2d()&&((t=document.createElement("div")).setAttribute("class","label__segment-percentages"),i='<ul class="segment-percentage__list">',a=l.getPercentages2d(!0),l.subLabels.forEach(function(t,e){var r="percent"===l.subLabelValue?"".concat(a[n][e],"%"):l.formatter((0,d.formatNumber)(l.labelValues[n][e],l.precision));i+="<li>".concat(l.subLabels[e],':\n    <span class="percentage__list-label">').concat(r,"</span>\n </li>")}),i+="</ul>",t.innerHTML=i,e.appendChild(t)),u.appendChild(e)}),this.container.appendChild(u)}},{key:"addSubLabels",value:function(){var t,r,n=this;this.subLabels&&((t=document.createElement("div")).setAttribute("class","svg-funnel-js__subLabels"),r="",this.subLabels.forEach(function(t,e){r+='<div class="svg-funnel-js__subLabel svg-funnel-js__subLabel-'.concat(e+1,'">\n    <div class="svg-funnel-js__subLabel--color"\n        style="').concat((0,s.generateLegendBackground)(n.colors[e],n.gradientDirection),'"></div>\n    <div class="svg-funnel-js__subLabel--title">').concat(t,"</div>\n</div>")}),t.innerHTML=r,this.container.appendChild(t))}},{key:"createContainer",value:function(){if(!this.containerSelector)throw new Error("Container is missing");if("string"==typeof this.containerSelector){if(this.container=document.querySelector(this.containerSelector),!this.container)throw new Error("Container cannot be found (selector: ".concat(this.containerSelector,")."))}else{if(!(this.container instanceof HTMLElement))throw new Error("Container must either be a selector string or an HTMLElement.");this.container=this.containerSelector}this.container.classList.add("svg-funnel-js"),this.graphContainer=document.createElement("div"),this.graphContainer.classList.add("svg-funnel-js__container"),this.container.appendChild(this.graphContainer),"vertical"===this.direction&&this.container.classList.add("svg-funnel-js--vertical")}},{key:"setLabelValues",value:function(t){return this.labelValues=t,this}},{key:"setGraphValues",value:function(t){return this.graphValues=t,this}},{key:"setDirection",value:function(t){return this.direction=t,this}},{key:"setHeight",value:function(t){return this.height=t,this}},{key:"setWidth",value:function(t){return this.width=t,this}},{key:"getValues2d",value:function(){var e=[];return(0<arguments.length&&void 0!==arguments[0]&&arguments[0]?this.labelValues:this.graphValues).forEach(function(t){e.push(t.reduce(function(t,e){return t+e},0))}),e}},{key:"getPercentages2d",value:function(){var r=[];return(0<arguments.length&&void 0!==arguments[0]&&arguments[0]?this.labelValues:this.graphValues).forEach(function(t){var e=t.reduce(function(t,e){return t+e},0);r.push(t.map(function(t){return 0===e?0:(0,d.roundPoint)(100*t/e)}))}),r}},{key:"createPercentages",value:function(){var t=[],t=this.is2d()?this.getValues2d(!0):f(this.labelValues),e=Math.max.apply(Math,f(t));return t.map(function(t){return 0===t?0:(0,d.roundPoint)(100*t/e)})}},{key:"applyGradient",value:function(t,e,r,n){for(var t=null===t.querySelector("defs")?(0,s.createSVGElement)("defs",t):t.querySelector("defs"),n=(0,l.default)("funnelGradient-".concat(n,"-")),i=(0,s.createSVGElement)("linearGradient",t,{id:n}),a=("vertical"===this.gradientDirection&&(0,s.setAttrs)(i,{x1:"0",x2:"0",y1:"0",y2:"1"}),r.length),o=0;o<a;o++)(0,s.createSVGElement)("stop",i,{"stop-color":r[o],offset:"".concat(Math.round(100*o/(a-1)),"%")});(0,s.setAttrs)(e,{fill:'url("#'.concat(n,'")'),stroke:'url("#'.concat(n,'")')})}},{key:"makeSVG",value:function(){for(var t=(0,s.createSVGElement)("svg",this.graphContainer,{width:this.getWidth(),height:this.getHeight()}),e=this.getCrossAxisPoints().length-1,r=0;r<e;r++){var n=(0,s.createSVGElement)("path",t),i=this.is2d()?this.colors[r]:this.colors,a="string"==typeof i||1===i.length?"solid":"gradient";"solid"==a?(0,s.setAttrs)(n,{fill:i,stroke:i}):"gradient"==a&&this.applyGradient(t,n,i,r+1),t.appendChild(n)}this.graphContainer.appendChild(t)}},{key:"getSVG",value:function(){var t=this.container.querySelector("svg");if(t)return t;throw new Error("No SVG found inside of the container")}},{key:"getWidth",value:function(){return this.width||this.graphContainer.clientWidth}},{key:"getHeight",value:function(){return this.height||this.graphContainer.clientHeight}},{key:"getPathDefinitions",value:function(){for(var t,e,r,n,i=this.getCrossAxisPoints().length-1,a=[],o=0;o<i;o++)this.isVertical()?(r=this.getCrossAxisPoints()[o],t=this.getCrossAxisPoints()[o+1],e=this.getMainAxisPoints(),r=(0,u.createVerticalPath)(o,r,t,e),a.push(r)):(t=this.getMainAxisPoints(),e=this.getCrossAxisPoints()[o],r=this.getCrossAxisPoints()[o+1],n=(0,u.createPath)(o,t,e,r),a.push(n));return a}},{key:"getPathMedian",value:function(t){var r,n,i,e,a,o,s,l;return this.isVertical()?(e=this.getCrossAxisPoints()[t],r=this.getCrossAxisPoints()[t+1],a=this.getMainAxisPoints(),n=[],i=[],e.forEach(function(t,e){t=(t+r[e])/2;n.push(t-1),i.push(1+t)}),(0,u.createVerticalPath)(t,n,i,a)):(e=this.getMainAxisPoints(),a=this.getCrossAxisPoints()[t],o=this.getCrossAxisPoints()[t+1],s=[],l=[],a.forEach(function(t,e){t=(t+o[e])/2;s.push(t-1),l.push(1+t)}),(0,u.createPath)(t,e,s,l))}},{key:"drawPaths",value:function(){var r=this.getSVG().querySelectorAll("path");this.getPathDefinitions().forEach(function(t,e){r[e].setAttribute("d",t)})}},{key:"draw",value:function(){this.createContainer(),this.makeSVG(),this.addLabels(),this.is2d()&&this.addSubLabels(),this.drawPaths()}},{key:"makeVertical",value:function(){var t,e,r;return"vertical"!==this.direction&&(this.direction="vertical",this.container.classList.add("svg-funnel-js--vertical"),t=this.getSVG(),e=this.getHeight(),r=this.getWidth(),(0,s.setAttrs)(t,{height:e,width:r}),this.drawPaths()),!0}},{key:"makeHorizontal",value:function(){var t,e,r;return"horizontal"!==this.direction&&(this.direction="horizontal",this.container.classList.remove("svg-funnel-js--vertical"),t=this.getSVG(),e=this.getHeight(),r=this.getWidth(),(0,s.setAttrs)(t,{height:e,width:r}),this.drawPaths()),!0}},{key:"toggleDirection",value:function(){"horizontal"===this.direction?this.makeVertical():this.makeHorizontal()}},{key:"gradientMakeVertical",value:function(){if("vertical"!==this.gradientDirection){this.gradientDirection="vertical";for(var t=this.graphContainer.querySelectorAll("linearGradient"),e=0;e<t.length;e++)(0,s.setAttrs)(t[e],{x1:"0",x2:"0",y1:"0",y2:"1"})}return!0}},{key:"gradientMakeHorizontal",value:function(){if("horizontal"!==this.gradientDirection){this.gradientDirection="horizontal";for(var t=this.graphContainer.querySelectorAll("linearGradient"),e=0;e<t.length;e++)(0,s.removeAttrs)(t[e],"x1","x2","y1","y2")}return!0}},{key:"gradientToggleDirection",value:function(){"horizontal"===this.gradientDirection?this.gradientMakeVertical():this.gradientMakeHorizontal()}},{key:"updateWidth",value:function(t){this.width=t;var t=this.getSVG(),e=this.getWidth();return(0,s.setAttrs)(t,{width:e}),this.drawPaths(),!0}},{key:"updateHeight",value:function(t){this.height=t;var t=this.getSVG(),e=this.getHeight();return(0,s.setAttrs)(t,{height:e}),this.drawPaths(),!0}},{key:"updateData",value:function(t){var e=this.container.querySelector(".svg-funnel-js__labels"),r=this.container.querySelector(".svg-funnel-js__subLabels");e&&e.remove(),r&&r.remove(),this.labels=[],this.colors=(0,s.getDefaultColors)(this.is2d()?this.getSubDataSize():2),this.labelValues=[],this.graphValues=[],this.percentages=[],void 0!==t.labels&&(this.labels=n.getLabels({data:t})),void 0!==t.colors&&(this.colors=t.colors||(0,s.getDefaultColors)(this.is2d()?this.getSubDataSize():2)),void 0!==t.graphValues&&(Object.prototype.toString.call(t.graphValues[0])!==Object.prototype.toString.call(this.graphValues[0])?(this.container.querySelector("svg").remove(),this.labelValues=n.getLabelValues({data:t}),this.graphValues=n.getGraphValues({data:t}),this.makeSVG()):(this.labelValues=n.getLabelValues({data:t}),this.graphValues=n.getGraphValues({data:t})),this.drawPaths()),this.percentages=this.createPercentages(),this.addLabels(),void 0!==t.subLabels&&(this.subLabels=n.getSubLabels({data:t}),this.addSubLabels())}},{key:"update",value:function(t){var n=this;void 0!==t.displayPercent&&this.displayPercent!==t.displayPercent&&(!0===this.displayPercent?this.container.querySelectorAll(".label__percentage").forEach(function(t){t.remove()}):this.container.querySelectorAll(".svg-funnel-js__label").forEach(function(t,e){var e=n.percentages[e],r=document.createElement("div");r.setAttribute("class","label__percentage"),100!==e&&(r.textContent="".concat(e.toString(),"%"),t.appendChild(r))})),void 0!==t.height&&this.updateHeight(t.height),void 0!==t.width&&this.updateWidth(t.width),void 0!==t.gradientDirection&&("vertical"===t.gradientDirection?this.gradientMakeVertical():"horizontal"===t.gradientDirection&&this.gradientMakeHorizontal()),void 0!==t.direction&&("vertical"===t.direction?this.makeVertical():"horizontal"===t.direction&&this.makeHorizontal()),void 0!==t.data&&this.updateData(t.data)}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();r.default=t},{"./graph":2,"./number":4,"./path":5,"./random":6}],4:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.roundPoint=r.outputFormatter=r.formatNumber=void 0;r.roundPoint=function(t){return Math.round(10*t)/10},r.formatNumber=function(t){return Number(t.toFixed(1<arguments.length&&void 0!==arguments[1]?arguments[1]:2))},r.outputFormatter=function(t){return t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}},{}],5:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createVerticalPath=r.createVerticalCurves=r.createPath=r.createCurves=void 0;var i=t("./number");function s(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){{var r;if(t)return"string"==typeof t?n(t,e):"Map"===(r="Object"===(r={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var l=r.createCurves=function(t,e,r,n){return" C".concat((0,i.roundPoint)((r+t)/2),",").concat(e," ")+"".concat((0,i.roundPoint)((r+t)/2),",").concat(n," ").concat(r,",").concat(n)},u=r.createVerticalCurves=function(t,e,r,n){return" C".concat(t,",").concat((0,i.roundPoint)((n+e)/2)," ")+"".concat(r,",").concat((0,i.roundPoint)((n+e)/2)," ").concat(r,",").concat(n)};r.createPath=function(t,e,r,n){for(var i="M".concat(e[0],",").concat(r[0]),a=0;a<e.length-1;a++)i+=l(e[a],r[a],e[a+1],r[a+1]);i+=" L".concat(s(e).pop(),",").concat(s(n).pop());for(var o=e.length-1;0<o;o--)i+=l(e[o],n[o],e[o-1],n[o-1]);return i+=" Z"},r.createVerticalPath=function(t,e,r,n){for(var i="M".concat(e[0],",").concat(n[0]),a=0;a<e.length-1;a++)i+=u(e[a],n[a],e[a+1],n[a+1]);i+=" L".concat(s(r).pop(),",").concat(s(n).pop());for(var o=e.length-1;0<o;o--)i+=u(r[o],n[o],r[o-1],n[o-1]);return i+=" Z"}},{"./number":4}],6:[function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=function(t){return Math.random().toString(36).replace("0.",t||"")}},{}]},{},[1])(1)});